<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ATS Estimator</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <meta name="robots" content="noindex,nofollow,noarchive" />
  <style>
    
    <img src="/assets/images/logo-v2.png" alt="About To Shine Cleaning Logo">

    :root{
      --purple:#5b2a86;
      --blue:#2f7bdc;
      --yellow:#FFD84D;
      --ink:#111827;
      --muted:#6b7280;
      --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{font-family:Arial, sans-serif; margin:0; background:#f6f7fb; color:var(--ink)}
    .letterhead{
      background:linear-gradient(90deg, var(--purple), var(--blue));
      color:#fff; padding:16px 18px 14px;
      position:sticky; top:0; z-index:5;
    }
    .row{display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap;}
    .brand{font-weight:900; font-size:18px}
    .subtitle{opacity:.92; font-size:13px}
    .line{height:4px; background:var(--yellow); margin-top:10px; border-radius:999px}
    .wrap{max-width:980px; margin:0 auto; padding:14px}
    .card{background:#fff; border-radius:14px; padding:14px; margin:12px 0; box-shadow:0 6px 18px rgba(0,0,0,.08)}
    .grid{display:grid; grid-template-columns:1fr 1fr; gap:10px}
    @media (max-width:720px){.grid{grid-template-columns:1fr}}
    label{font-size:12px; color:var(--muted); display:block; margin-bottom:4px}
    input, select, textarea{
      width:100%; padding:10px; border:1px solid var(--border);
      border-radius:10px; font-size:14px; outline:none;
    }
    textarea{min-height:74px; resize:vertical}
    h3{margin:10px 0 6px; font-size:14px}
    .task{display:flex; gap:10px; align-items:flex-start; padding:10px; border:1px solid var(--border);
      border-radius:12px; margin:8px 0; cursor:pointer}
    .box{width:22px; height:22px; border:2px solid var(--purple); border-radius:6px;
      display:flex; align-items:center; justify-content:center; font-weight:900; color:var(--purple); flex:0 0 22px}
    .box.on{background:var(--yellow)}
    .task .name{font-weight:700; font-size:13px}
    .task .meta{font-size:12px; color:var(--muted); margin-top:2px}

    .sticky{
      position:sticky; bottom:0; background:#fff; border-top:1px solid var(--border);
      padding:12px; display:flex; justify-content:space-between; gap:10px; align-items:center; flex-wrap:wrap
    }
    button{border:0; border-radius:10px; padding:10px 12px; font-weight:900; cursor:pointer}
    .save{background:var(--purple); color:#fff}
    .ghost{background:#fff; border:1px solid var(--border)}
    .pill{display:inline-flex; gap:8px; align-items:center; padding:6px 10px; border-radius:999px;
      background:rgba(91,42,134,.08); color:var(--purple); border:1px solid rgba(91,42,134,.18); font-weight:900; font-size:12px}
    .modal{position:fixed; inset:0; background:rgba(0,0,0,.45); display:none; align-items:center; justify-content:center; padding:16px}
    .modal.on{display:flex}
    .modalCard{background:#fff; border-radius:14px; max-width:440px; width:100%; padding:14px}
    .modalTitle{font-weight:900}
    .note{font-size:12px; color:var(--muted); margin-top:8px}
    .row2{display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px}
    .Row{
      display:flex; align-items:center; gap:10px; font-size:13px; color:#111827;
      padding:8px 10px; border:1px solid var(--border); border-radius:12px; background:#fff; width:fit-content;
    }
    .Row input{width:auto}
    a.back{color:#fff; text-decoration:none; font-weight:900;}

    /* error banner */
    .errorBanner{
      white-space:pre-wrap;
      color:#b91c1c;
      background:#fff;
      border:1px solid #fecaca;
    }
  </style>
<script type="application/ld+json" id="ats-schema">{"@context": "https://schema.org", "@type": "CleaningService", "name": "About To Shine Cleaning", "url": "https://abouttoshinecleaning.com", "telephone": "+1-484-223-8496", "": "", "sameAs": ["https://g.page/r/CVKX4yXWXTEVEBM/review", "https://www.facebook.com/abouttoshinecleaning/", "https://www.yelp.com/biz/about-to-shine-cleaning-emmaus", "https://nextdoor.com/pages/about-to-shine-cleaning-emmaus-pa/", "https://www.yellowpages.com/emmaus-pa/mip/about-to-shine-cleaning-526438162"]}</script>
</head>

<body>
  <div class="letterhead">
    <div class="row">
      <div>
        <div class="brand">About To Shine Cleaning</div>
        <div class="subtitle">Residential Walkthrough Estimate</div>
      </div>
      <div class="row" style="gap:10px">
        <a class="back" href="/admin/">← Admin</a>
        <div class="pill" id="pillStatus">Draft</div>
      </div>
    </div>
    <div class="line"></div>
  </div>

  <div class="wrap" id="app">
    <!-- (Optional) keep for later. It won't break anything. -->
    <div class="card" id="authGate" style="display:none;">
      Checking admin access…
    </div>

    <!-- Error output from estimator.js -->
    <div class="card errorBanner" id="taskError" style="display:none;"></div>

    <!-- Client info -->
    <div class="card">
      <div class="grid">
        <div><label>Client Name</label><input id="clientName" placeholder="Last, First (recommended)"/></div>
        <div><label>Phone</label><input id="clientPhone" placeholder="(555) 555-5555"/></div>
        <div><label>Address</label><input id="clientAddress" placeholder="Street, City, State"/></div>
        <div><label>Preferred Day</label>
          <select id="prefDay">
            <option value="">Select</option>
            <option>Monday</option><option>Tuesday</option><option>Wednesday</option>
            <option>Thursday</option><option>Friday</option><option>Saturday</option><option>Sunday</option>
          </select>
        </div>

        <div><label>Preferred Schedule / Time Window</label><input id="prefTime" placeholder="e.g., mornings, after 2pm"/></div>
        <div><label>Allergies / sensitivities</label><input id="allergies" placeholder="e.g., fragrance-free"/></div>
        <div><label>Pets (names)</label><input id="pets" placeholder="e.g., Luna, Max"/></div>
      </div>

      <div style="margin-top:10px">
        <label>Notes</label>
        <textarea id="notes" placeholder="Notes for walkthrough..."></textarea>
      </div>
    </div>

    <!-- Tasks render here -->
    <div id="taskSections"></div>

    <!-- Sticky footer -->
    <div class="sticky">
      <div style="display:flex; flex-direction:column; gap:8px;">
        <div><b>Total:</b> <span id="total">$0.00</span></div>

        <label class="Row">
          <input type="checkbox" id="send" />
          estimate PDF to client
        </label>
      </div>

      <div style="display:flex; gap:10px; flex-wrap:wrap;">
        <button class="ghost" onclick="resetAll()">Reset</button>
        <button class="save" onclick="saveFinal()">Save Estimate (PDF)</button>
      </div>
    </div>
  </div>

  <!-- Modal for tier/qty -->
  <div class="modal" id="modal">
    <div class="modalCard">
      <div class="modalTitle" id="modalTitle">Task</div>
      <div class="note" id="modalHint">Select Tier (pricing only). Client PDF will NOT show tiers.</div>

      <div class="row2" id="tierRow">
        <div>
          <label>Tier</label>
          <select id="tier">
            <option value="1">Tier 1</option>
            <option value="2">Tier 2</option>
            <option value="3">Tier 3</option>
          </select>
        </div>

        <div id="qtyWrap">
          <label>How many?</label>
          <select id="qty"></select>
        </div>
      </div>

      <div style="display:flex; gap:10px; margin-top:14px; justify-content:flex-end;">
        <button class="ghost" onclick="toggleOff()">Unselect</button>
        <button class="save" onclick="confirmModal()">Confirm</button>
      </div>
    </div>
  </div>

  <!-- estimator logic -->
  <script src="/admin/estimator/estimator.js"></script>

  <!-- Show error banner if estimator.js sets text -->
  <script>
    // tiny helper: if estimator.js writes taskError textContent, show card
    const _taskErr = document.getElementById("taskError");
    const _obs = new MutationObserver(() => {
      if (_taskErr && _taskErr.textContent.trim()) _taskErr.style.display = "block";
    });
    if (_taskErr) _obs.observe(_taskErr, { childList:true, subtree:true, characterData:true });
  </script>
</body>
</html>
<link rel="icon" type="image/png" href="/assets/images/Logo-v2.png">
<link rel="apple-touch-icon" href="/assets/images/Logo-v2.png">
